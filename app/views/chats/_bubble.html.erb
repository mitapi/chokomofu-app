<section style="width:550px; height:190px; border-color:#ffc876;""
         class="rounded-2xl border-[3px] bg-slate-50 mt-2
                grid [grid-template-rows:1fr_auto] p-6 shadow">
  <div
    data-controller="conversation-step"
    data-action="click->conversation-step#next"
    class="cursor-pointer"
  >
    <% conversation_lines(@conv).each_with_index do |block, index| %>
      <div
        data-conversation-step-target="line"
        class="<%= index.zero? ? '' : 'hidden' %> mb-2"
      >
        <%= simple_format(h(block)) %>
      </div>
    <% end %>
  </div>

  <% if @choices.any? %>
    <ul class="flex justify-center pt-2 gap-6">
      <% @choices.each do |c| %>
        <li>
          <%= link_to choice_label_html(c), chat_path(conversation_id: c.next_conversation_id),
                class: "inline-block rounded-xl border-2 border-amber-400 bg-white px-3 py-2 hover:bg-amber-400/20 transition" %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <div class="flex justify-end pt-2">
      <%= link_to "会話をとじる", main_path,
            class: "inline-block rounded-xl border-2 border-amber-400 bg-white px-3 py-2 hover:bg-amber-400/20 transition" %>
    </div>
  <% end %>
</section>