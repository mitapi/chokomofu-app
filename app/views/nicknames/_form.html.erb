<%= form_with model: user, url: nickname_path do |f| %>
  <section class="flex font-medium items-center mt-[30px] relative">
    <%= f.label :nickname, 'ニックネーム' %>
  </section>

  <section class="flex justify-center items-center mt-[10px] mb-[25px] relative">
    <%= f.text_field :nickname, 
          class: "font-medium text-[17px] w-[400px]
                  rounded border border-gray-300 bg-white p-2 outline-none focus:ring focus:ring-yellow-200",
          maxlength: 10, autofocus: true, placeholder: "例）ねこみざわ" %>
  </section>

  <%= render 'shared/error_messages', object: f.object %>

  <div class="mt-6">
    <h2 class="text-sm font-medium mb-2">利用規約（抜粋）</h2>
    <div role="region" aria-label="利用規約の抜粋" tabindex="0"
         class="max-h-56 overflow-y-auto rounded-xl border border-amber-200 bg-white/90 p-4 text-sm w-[400px]">
      <%= render "static/terms_body" %>
    </div>

    <!-- 規約チェック（未同意のときだけ表示） -->
    <% if @user.terms_agreed_at.present? %>
      <p class="text-xs text-gray-500 mb-4">
        規約同意済み（<%= @user.terms_agreed_at.strftime("%Y/%m/%d") %>）
      </p>
    <% else %>
      <div class="mb-4">
        <label class="inline-flex items-start gap-2">
          <%= check_box_tag :terms, "1", false, required: true %>
          <span>
            <a href="<%= terms_path %>" class="underline" target="_blank" rel="noopener">利用規約</a> に同意します
          </span>
        </label>
      </div>
    <% end %>

    <p class="mt-2 text-xs">
      くわしくは <%= link_to "利用規約全文", terms_path, class: "underline text-amber-700" %> をご確認ください。
    </p>
  </div>

  <section class="flex justify-center bottom-[300px]">
    <%= f.submit "保存する",
          class: "group
                  font-bold flex h-10 items-center justify-center 
                  rounded-md inline-block bg-amber-400 px-4 py-2 text-white hover:bg-orange-400" %>
  </section>
<% end %>